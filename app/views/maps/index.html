<% content_for :heads do %>
    <script type="text/javascript" src="/js/jquery-ui-1.8.16.custom.min.js"></script>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript" src="/js/maps.js"></script>
    
    <link href="/css/maps.css" media="screen" rel="stylesheet" type="text/css">
<% end %>

    

    <%= form_for @place, :remote => true, :url => { :action => 'create' }, :html => { :multipart => true, :target => "results" }  do |f| %>
    <table>
        
        <% if @place.errors.any? %>
            <tr>
                <td>
                    <div id="results"></div>
                </td>
            </tr>
        <% end %>
            
        <tr>
            <td>
                <%= f.label "place address" %>
            </td>
            <td>
                <%= f.text_field :address, :id => :address %>
            </td>
        </tr>
        <tr>
            <td>
                <%= f.label "Beer rate" %>
            </td>
            <td>
                <%= f.number_field :rate %>
                <%= f.hidden_field :latitude %>    
                <%= f.hidden_field :longitude %>            
            </td>        
        </tr>
        <tr>
            <td>
            </td>
            <td>
                <%= f.submit :Share! %>
            </td>
        </tr>
        
    </table>
    <% end %>
    
    <div id="map_canvas"></div><br/>
    
    <script type="text/javascript">
        function fill_map()
        {   
            <% @places.each do |place| %>
                var location = new google.maps.LatLng(<%= place.latitude %>, <%= place.longitude %>);
                var marker = new_marker();
                marker.setPosition(location);
                marker.setTitle("The beer rate here is: <%= place.rate %>");
            <% end %>    
        }
    </script>
    
</body>
